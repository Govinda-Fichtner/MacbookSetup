---
# MCP Server Registry Configuration
# Centralized configuration for all MCP (Model Context Protocol) servers
# Supports both registry images and local repository builds

servers:
  github:
    name: GitHub MCP Server
    server_type: "api_based"  # Uses environment variables for API authentication
    description: "GitHub repository management and code analysis"
    category: "code"
    source:
      type: registry
      image: mcp/github-mcp-server:latest
    environment_variables:
      - "GITHUB_TOKEN"
      - "GITHUB_PERSONAL_ACCESS_TOKEN"
    health_test:
      parse_mode: json
      path: "/health"
      expected_status: 200
      expected_response:
        status: "ok"
    capabilities:
      - "repository_management"
      - "issue_tracking"
      - "pull_requests"
      - "code_search"

  circleci:
    name: CircleCI MCP Server
    server_type: "api_based"  # Uses environment variables for API authentication
    description: "CircleCI pipeline monitoring and management"
    category: "cicd"
    source:
      type: build
      repository: https://github.com/CircleCI-Public/mcp-server-circleci.git
      image: local/mcp-server-circleci:latest
      build_context: "."
    environment_variables:
      - "CIRCLECI_TOKEN"
      - "CIRCLECI_BASE_URL"
    health_test:
      parse_mode: json
      path: "/health"
      expected_status: 200
      expected_response:
        status: "ok"
    capabilities:
      - "pipeline_monitoring"
      - "job_management"
      - "artifact_access"
      - "environment_variables"

  inspector:
    name: "MCP Inspector"
    server_type: "standalone"  # Self-contained, no external API dependencies
    description: "Official Model Context Protocol visual testing and debugging tool"
    category: "development"
    source:
      type: registry
      image: "mcp/inspector:latest"  # Official MCP Inspector containerized
    ports:
      - "6274:6274"  # MCPI client UI
      - "6277:6277"  # MCPP proxy server
    networks:
      - "mcp-network"
    environment_variables:
      - "MCP_AUTO_OPEN_ENABLED"
      - "CLIENT_PORT"
      - "SERVER_PORT"
      - "MCP_SERVER_REQUEST_TIMEOUT"
    health_test:
      parse_mode: direct
      path: "/"
      expected_status: 200
      expected_response: "<!DOCTYPE html>"  # HTML response from UI
    capabilities:
      - "visual_testing"
      - "server_debugging"
      - "protocol_inspection"
      - "configuration_export"
      - "cli_mode"

  filesystem:
    name: "Filesystem MCP Server"
    server_type: "mount_based"  # Uses Docker mounts instead of environment variables
    description: "Official Anthropic filesystem operations server for local file management"
    category: "filesystem"
    source:
      type: registry
      image: "mcp/filesystem:latest"
    environment_variables:
      - "FILESYSTEM_ALLOWED_DIRS"
    mount_configuration:
      source_env_var: "FILESYSTEM_ALLOWED_DIRS"
      container_path: "/project"
      default_fallback: "$(pwd)"
    health_test:
      parse_mode: json
      path: "/health"
      expected_status: 200
      expected_response:
        status: "ok"
    capabilities:
      - "file_operations"
      - "directory_management"
      - "file_search"
      - "file_metadata"
      - "secure_access"

  docker:
    name: "Docker MCP Server (QuantGeekDev)"
    server_type: "privileged"
    description: "Docker container and compose management via QuantGeekDev/docker-mcp"
    category: "infrastructure"
    source:
      type: registry
      image: "ghcr.io/metorial/mcp-container--quantgeekdev--docker-mcp--docker-mcp:latest"
    environment_variables:
      - "DOCKER_HOST"
      - "DOCKER_COMPOSE_PROJECT_NAME"
    privileged_configuration:
      docker_socket: true
      networks:
        - "mcp-network"
      volumes:
        - "/var/run/docker.sock:/var/run/docker.sock"
    health_test:
      parse_mode: json
      path: "/health"
      expected_status: 200
      expected_response:
        status: "ok"
    capabilities:
      - "container_management"
      - "compose_stack_deployment"

# Global MCP configuration
global:
  build_directory: "./mcp_builds"
  # config_path: Legacy - now using --env-file approach
  network_name: "mcp-network"
  default_timeout: 30
